Consider the following schema:  
Employee (EmpNo, EmpName, Gender, Salary, Address, DNo) Department 
(DeptNo, DeptName, Location)  
1. Create Employee table with following constraints:  
• Make EmpNo as Primary key.  
• Do not allow EmpName, Gender, Salary and Address to have null values.  
• Allow Gender to have one of the two values: ‘M’, ‘F’.
soln
create table Employee (
EmpNo int primary key, 
EmpName varchar(5) not null, 
Gender char(1) check(Gender in ('M' , 'F')) not null , 
Salary int not null, 
Address varchar(5) not null, 
DNo int );

2. Create Department table with following:  
• Make DeptNo as Primary key  
• Make DeptName as candidate key  
soln
create table Department (
DeptNo int primary key, 
DeptName varchar(5) unique not null, 
Location varchar(5));

3. Make DNo of Employee as foreign key which refers to DeptNo of Department. 
soln
alter table Employee
add constraint fk_emp_dept
foreign key (DNo)
references Department(DeptNo);

4. Insert few tuples into Employee and Department which satisfies the above 
constraints. 
soln
insert into Department(DeptNo, DeptName, Location) values('1','cse','ab5');
insert into Department(DeptNo, DeptName, Location) values('2','chem','ab2');
insert into Department(DeptNo, DeptName, Location) values('3','ece','ab5');
insert into Employee (EmpNo, EmpName, Gender, Salary, Address, DNo) values (1,'deb','M',100,'mum',1);
insert into Employee (EmpNo, EmpName, Gender, Salary, Address, DNo) values (2,'rai','F',101,'del',2);
insert into Employee (EmpNo, EmpName, Gender, Salary, Address, DNo) values (3,'ary','M',103,'mum',1); 

5. Try to insert few tuples into Employee and Department which violates some of the 
above constraints.
soln
insert into Department(DeptNo, DeptName, Location) values('1','cse','ab5');
insert into Department(DeptNo, DeptName, Location) values('2','chem','ab2');
insert into Department(DeptNo, Location) values('1','ab5');
insert into Employee (EmpNo, EmpName, Gender, Salary, Address, DNo) values (1,'deb','M',100,'mum',1);
insert into Employee (EmpNo, EmpName, Gender, Salary, Address, DNo) values (2,'rai','G',101,'del',2);
insert into Employee (EmpNo, EmpName, Gender, Salary, Address, DNo) values (1,'ary','M',103,'mum',1); 

  
6. Try to modify/delete a tuple which violates a constraint.  
(Ex:   Drop a department tuple which has one or more employees
soln
delete from Department where DeptNo='1';

7. Modify the foreign key constraint of Employee table such that whenever a 
department tuple is deleted, the employees belonging to that department will also be 
deleted.
soln
alter table Employee drop constraint fk_emp_dept;
alter table Employee
add constraint fk_emp_dept
foreign key (DNo)
references Department(DeptNo)
on delete set null;

8. Create a named constraint to set the default salary to 10000 and test the constraint by         
inserting a new record.  
soln
alter table Employee add constraint sal_cons check(salary>=10000); -- cannot add default with add constrain therefore using with check
UPDATE Employee
SET Salary = 10000;

9. List all Students with names and their department names.   
soln
select name, dept_name from student;
NAME                 DEPT_NAME
-------------------- --------------------
Zhang                Comp. Sci.
Shankar              Comp. Sci.
Brandt               History
Chavez               Finance
Peltier              Physics
Levy                 Physics
Williams             Comp. Sci.
Sanchez              Music
Snow                 Physics
Brown                Comp. Sci.
Aoi                  Elec. Eng.
Bourikas             Elec. Eng.
Tanaka               Biology

10. List all instructors in CSE department.    
soln
select name from instructor where dept_name='Comp. Sci.';
NAME
--------------------
Srinivasan
Katz
Brandt

11. Find the names of courses in CSE department which have 3 credits.    
soln
select title from Course where dept_name='Comp. Sci.' and credits=3; 
TITLE
--------------------------------------------------
Robotics
Image Processing
Database System Concepts

12. For the student with ID 12345 (or any other value), show all course-id and title of all 
courses registered for by the student.    
soln
select s.name, c.course_id, c.title
from takes t , course c , student s
where t.course_id = c.course_id and t.ID = s.ID and s.ID='12345';
NAME                 COURSE_I TITLE
-------------------- -------- --------------------------------------------------
Shankar              CS-101   Intro. to Computer Science
Shankar              CS-190   Game Design
Shankar              CS-315   Robotics
Shankar              CS-347   Database System Concepts


13. List all the instructors whose salary is in between 40000 and 90000. Retrieving 
records from multiple tables:  
soln
select i.name, d.dept_name
from instructor i, department d
where i.dept_name=d.dept_name
and i.salary between 40000 and 90000;
NAME                 DEPT_NAME
-------------------- --------------------
Srinivasan           Comp. Sci.
Wu                   Finance
Mozart               Music
El Said              History
Gold                 Physics
Katz                 Comp. Sci.
Califieri            History
Singh                Finance
Crick                Biology
Kim                  Elec. Eng.
  
14. Display the IDs of all instructors who have never taught a course.    
soln
select i.name
from instructor i
where i.id not in (select t.ID from teaches t);
NAME
--------------------
Gold
Califieri
Singh

15. Find the student names, course names, and the year, for all students those who have 
attended classes in room-number 303.    
soln
SELECT s.name, c.title, sec.year
FROM student s, takes t, section sec, course c
WHERE s.ID = t.ID
  AND t.course_id = sec.course_id
  AND t.sec_id = sec.sec_id
  AND t.semester = sec.semester
  AND t.year = sec.year
  AND sec.course_id = c.course_id
  AND sec.room_number = '303';



16. For all students who have opted courses in 2015, find their names and course id’s with
the attribute course title replaced by c-name.   
soln 
soln
SELECT s.name,
       c.course_id,
       c.title AS c_name
FROM student s, takes t, course c
WHERE s.ID = t.ID
  AND t.course_id = c.course_id
  AND t.year = 2015;


17. Find the names of all instructors whose salary is greater than the salary of at least one 
instructor of CSE department and salary replaced by inst-salary. String Operations 
(Use %, _, LIKE):   
soln
SELECT name,
       salary AS inst_salary
FROM instructor
WHERE salary >
      (SELECT MIN(salary)
       FROM instructor
       WHERE dept_name = 'Comp. Sci.');



18. Find the names of all instructors whose department name includes the substring  
‘ch’.    
soln
SELECT name
FROM instructor
WHERE dept_name LIKE '%ch%';


19. List the student names along with the length of the student names.   
soln
SELECT name,
       LENGTH(name) AS name_length
FROM student;


20. List the department names and 3 characters from 3rd position of each department name   
soln
SELECT dept_name,
       SUBSTRING(dept_name FROM 3 FOR 3) AS part
FROM department;


21. List the instructor names in upper case.   
soln
SELECT UPPER(name)
FROM instructor;


22. Replace NULL with value1(say 0) for a column in any of the table   
soln
SELECT name,
       COALESCE(salary, 0) AS salary
FROM instructor;

   
23. Display the salary and salary/3 rounded to nearest hundred from Instructor.   
soln
SELECT salary,
       ROUND(salary / 3, -2) AS rounded_salary
FROM instructor;


24. Display the birth date of all the employees in the following format:  
• ‘DD-MON-YYYY’  
• ‘DD-MON-YY’  
• ‘DD-MM-YY’  
soln
ALTER TABLE Employee
ADD DOB DATE;
UPDATE Employee SET DOB = DATE '2003-05-12' WHERE EmpNo = 1;
UPDATE Employee SET DOB = DATE '2002-11-25' WHERE EmpNo = 2;
UPDATE Employee SET DOB = DATE '2004-01-08' WHERE EmpNo = 3;

SELECT TO_CHAR(DOB, 'DD-MON-YYYY') FROM Employee;
SELECT TO_CHAR(DOB, 'DD-MON-YY') FROM Employee;
SELECT TO_CHAR(DOB, 'DD-MM-YY') FROM Employee;


25. List the employee names and the year (fully spelled out) in which they are born  
• ‘YEAR’  
• ‘Year’  
• ‘year’ 
soln
SELECT EmpName,
       TO_CHAR(DOB, 'YEAR') AS BIRTH_YEAR
FROM Employee;
SELECT EmpName,
       INITCAP(TO_CHAR(DOB, 'YEAR')) AS BIRTH_YEAR
FROM Employee;
SELECT EmpName,
       LOWER(TO_CHAR(DOB, 'YEAR')) AS BIRTH_YEAR
FROM Employee;




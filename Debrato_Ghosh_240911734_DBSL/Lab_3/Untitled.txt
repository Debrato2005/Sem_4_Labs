Implement the following Queries on UNIVERSITY Database:  
Set Operations  
UNION (Use union all to retain duplicates):  
1. Find courses that ran in Fall 2009 or in Spring 2010 
SOLN
select course_id
from section
where semester = 'Fall' and year = 2009
union all
select course_id
from section
where semester = 'Spring' and year = 2010;
COURSE_I
--------
CS-101
CS-347
PHY-101
CS-101
CS-315
CS-319
CS-319
FIN-201
HIS-351
MU-199

INTERSECT (Use intersect 
all to retain duplicates):  
2. Find courses that ran in Fall 2009 and in spring 2010  
SOLN
select course_id
from section
where semester = 'Fall' and year = 2009
intersect 
select course_id
from section
where semester = 'Spring' and year = 2010;

COURSE_I
--------
CS-101

MINUS:  
3. Find courses that ran in Fall 2009 but not in Spring 2010  
Null values  
SOLN
select course_id
from section
where semester = 'Fall' and year = 2009
minus
select course_id
from section
where semester = 'Spring' and year = 2010;
COURSE_I
--------
CS-347
PHY-101

4. Find the name of the course for which none of the students registered.   
SOLN
select title
from course
where course_id not in (select course_id from takes );

TITLE
--------------------------------------------------
Computational Biology

Nested Subqueries 
Set Membership (in / not in):  
5. Find courses offered in Fall 2009 and in Spring 2010. 
SOLN
select course_id from section 
where semester='Fall' and year=2009 and course_id in (select course_id from section
where semester='Spring' and year=2010);
COURSE_I
--------
CS-101
 
6. Find the total number of students who have taken course taught by the instructor with 
ID 10101.
SOLN
select count(distinct id) as count_10101 --Same student may take multiple courses taught by instructor 10101
from takes t
where t.course_id in ( select course_id from teaches te where te.id='10101');
COUNT_10101
-----------
          6
  
7. Find courses offered in Fall 2009 but not in Spring 2010. 
SOLN
select course_id from section
where semester='Fall' and year=2009 and course_id not in (select course_id from section
where semester='Spring' and year=2010);
COURSE_I
--------
CS-347
PHY-101
 
8. Find the names of all students whose name is same as the instructor’s name.  
SOLN
select name from student where name in (select name from instructor);
SQL> select name from student where name in (select name from instructor);

NAME
--------------------
Brandt

Set Comparison (>=some/all)
9. Find names of instructors with salary greater than that of some (at least one) 
instructor in the Biology department.  
SOLN
select name
from instructor i
where i.salary > some(select salary from instructor where dept_name='Biology');
NAME
--------------------
Einstein
Brandt
Wu
Gold
Kim
Singh
Katz

10. Find the names of all instructors whose salary is greater than the salary of all 
instructors in the Biology department. 
SOLN
select name
from instructor i
where i.salary > all(select salary from instructor where dept_name='Biology');
NAME
--------------------
Katz
Singh
Kim
Gold
Wu
Brandt
Einstein(select max(avg_sal) from (
 
11. Find the departments that have the highest average salary. 
SOLN
select dept_name --cannot do without groupby logic
from instructor
group by dept_name having avg(salary)>=(select max(avg_sal) from ((select avg(salary) as avg_sal from instructor)));
DEPT_NAME
--------------------
Elec. Eng.
Physics
Comp. Sci.
Finance
 
12. Find the names of those departments whose budget is lesser than the average salary 
of all instructors.  
SOLN
select dept_name --cannot do without groupby logic
from instructor
group by dept_name having avg(salary)<(select avg(salary) as avg_sal from instructor);
DEPT_NAME
--------------------
Biology
Music
History

Test for Empty Relations (exists/ not exists)  
13. Find all courses taught in both the Fall 2009 semester and in the Spring 2010 
semester.  
SOLN
select distinct s.course_id
from section s
where s.semester = 'Fall' and s.year = 2009 and exists (select * from section s2 where s2.course_id=s.course_id and
s2.semester = 'Spring' and s2.year = 2010);
COURSE_I
--------
CS-101

14. Find all students who have taken all courses offered in the Biology department.  
Test for Absence of Duplicate Tuples  
SOLN
select s.id, s.name
from student s
where not exists (
    select c.course_id
    from course c
    where c.dept_name = 'Biology'
    and not exists (
        select *
        from takes t
        where t.id = s.id
        and t.course_id = c.course_id
    )
);
no rows selected

15. Find all courses that were offered at most once in 2009.
SOLN
select course_id
from section
where year = 2009
group by course_id
having count(*) = 1;
--unique doesnt work
COURSE_I
--------
BIO-101
CS-101
CS-347
EE-181
PHY-101

16. Find all the students who have opted at least two courses offered by CSE department. 
Subqueries in the From Clause  
SOLN
select s.id, s.name
from student s,
     (
       select t.id
       from takes t, course c
       where t.course_id = c.course_id
       and c.dept_name = 'Comp. Sci.'
       group by t.id
       having count(distinct t.course_id) >= 2
     ) x
where s.id = x.id;
ID    NAME
----- --------------------
00128 Zhang
12345 Shankar
45678 Levy
54321 Williams
76543 Brown
98765 Bourikas

17. Find the average instructors salary of those departments where the average salary is 
greater than 42000 
SOLN
select dept_name, avg_salary
from (
    select dept_name, avg(salary) as avg_salary
    from instructor
    group by dept_name
)
where avg_salary > 42000;
DEPT_NAME            AVG_SALARY
-------------------- ----------
Elec. Eng.                80000
Physics                   91000
Comp. Sci.           77333.3333
Finance                   85000
Biology                   72000
History                   61000
 
Views  
18. Create a view all_courses consisting of course sections offered by Physics 
department in the Fall 2009, with the building and room number of each section. 
SOLN

 
19. Select all the courses from all_courses view.  
SOLN


20. Create a view department_total_salary consisting of department name and total 
salary of that department.
SOLN

